x <- 0:6 #A的被选择次数
f <- c(0,0,3,8,10,7,2) #对应的频数
theta <- sum(rep(x,f))/sum(6*f) #由样本估计A的概率
for (i in 0:6) pp[i+1] = dbinom(i,6,theta) #计算期望频率
f <- c(sum(f[1:3]),f[4:7]) #合并前三组的频数
p_0 <- c(sum(pp[1:3]),pp[4:7]) #合并前三组的期望频率
e <- 30*p_0 #期望频数
Q <- sum((f-e)^2/e) #计算统计量的值
pchisq(Q,df = 5-1-1,ncp = 0,lower.tail = F) #求出统计量的P值
#远大于0.05，所以不可以拒绝原假设，认为是二项分布，且A要比B好
